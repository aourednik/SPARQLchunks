<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Run SPARQL Chunks and Inline Functions to Retrieve Data • SPARQLchunks</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Run SPARQL Chunks and Inline Functions to Retrieve Data">
<meta name="description" content="Allows to run SPARQL chunks in R-markdown files. Also provides inline functions to send a SPARQL query to an endpoint and retrieve data in data frame or list form.">
<meta property="og:description" content="Allows to run SPARQL chunks in R-markdown files. Also provides inline functions to send a SPARQL query to an endpoint and retrieve data in data frame or list form.">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">SPARQLchunks</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/use.html">SPARQL chunks and queries</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/aourednik/SPARQLchunks/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="sparqlchunks">SPARQLchunks<a class="anchor" aria-label="anchor" href="#sparqlchunks"></a>
</h1></div>
<!-- badges: start -->

<p>Coding in R is useless without interesting research questions; and even the best questions remain unanswered without data. RStudio provides a number of convenient ways to access data, among which the possibility to write SQL code chunks in Rmarkdown, to run these chunks and to assign the value of the query result directly to a variable of your choice. No such thing is available yet for SPARQL queries: the ones that allow you to navigate gigantic knowledge graphs that incarnate the conscience of the semantic web. This is where the SPARQLchunks package steps in.</p>
<p>This package allows you to query SPARQL endpoints in two different ways:</p>
<ol style="list-style-type: decimal">
<li>It allows you to run SPARQL chunks in Rmarkdown files.</li>
<li>It provides inline functions to send SPARQL queries to a user-defined endpoint and retrieve data in <em>dataframe</em> form (<code>sparql2df</code>) or <em>list</em> form (<code>sparql2list</code>).</li>
</ol>
<p>Endpoints can be reached from behind corporate firewalls on Windows machines thanks to automatic proxy detection. See <a href="https://ourednik.info/maps/2021/12/14/execute-sparql-chunks-in-r-markdown/" class="external-link">Execute SPARQL chunks in R Markdown</a>.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Most users can install by running this command</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"aourednik/SPARQLchunks"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>If you are behind a corporate firewall on a Windows machine, direct access to GitHub might be blocked. If that is your case, run this installation code instead:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">proxy_url</span> <span class="op">&lt;-</span> <span class="fu">curl</span><span class="fu">::</span><span class="fu"><a href="https://jeroen.r-universe.dev/curl/reference/ie_proxy.html" class="external-link">ie_get_proxy_for_url</a></span><span class="op">(</span><span class="st">"https://github.com"</span><span class="op">)</span></span>
<span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/set_config.html" class="external-link">set_config</a></span><span class="op">(</span><span class="fu">httr</span><span class="fu">::</span><span class="fu"><a href="https://httr.r-lib.org/reference/use_proxy.html" class="external-link">use_proxy</a></span><span class="op">(</span><span class="va">proxy_url</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_url</span><span class="op">(</span><span class="st">"https://github.com/aourednik/SPARQLchunks/archive/refs/heads/main.zip"</span>, build_vignettes <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="use">Use<a class="anchor" aria-label="anchor" href="#use"></a>
</h2>
<p>To use the full potential of the package you need to load the library and <em>tell knitr that a SPARQL engine exists</em>:</p>
<p><code>{r setup, include=FALSE} library(SPARQLchunks) knitr::knit_engines$set(sparql = SPARQLchunks::eng_sparql)</code></p>
<p>Once you have done so, you can run SPARQL chunks:</p>
<div class="section level3">
<h3 id="chunks">Chunks<a class="anchor" aria-label="anchor" href="#chunks"></a>
</h3>
<div class="section level4">
<h4 id="retrieve-a-data-frame">Retrieve a data frame<a class="anchor" aria-label="anchor" href="#retrieve-a-data-frame"></a>
</h4>
<p><em>output.var</em>: the name of the data frame you want to store the results in</p>
<p><em>endpoint</em>: the URL of the SPARQL endpoint</p>
<p><em>autoproxy</em>: whether or not try to use the automatic proxy detection</p>
<p><em>auth</em>: authentication information for the sparql endpoint (as an httr authentication object, optional)</p>
<p>Example 1 (Swiss administration endpoint)</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="in">```{sparql output.var="queryres_df", endpoint="https://lindas.admin.ch/query"}</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a><span class="in">PREFIX schema: &lt;http://schema.org/&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="in">SELECT * WHERE {</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="in">  ?sub a schema:DataCatalog .</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="in">  ?subtype a schema:DataType .</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>Example 2 (Uniprot endpoint)</p>
<p>Note the use of attempt at automatic proxy detection.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="in">```{sparql output.var="tes5", endpoint="https://sparql.uniprot.org/sparql", autoproxy=TRUE}</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a><span class="in">PREFIX up: &lt;http://purl.uniprot.org/core/&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="in">SELECT ?taxon</span></span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a><span class="in">FROM &lt;http://sparql.uniprot.org/taxonomy&gt;</span></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="in">WHERE {</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="in">    ?taxon a up:Taxon .</span></span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a><span class="in">} LIMIT 500</span></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
<p>Example 3 (WikiData endpoint):</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="in">```{sparql output.var="res.df", endpoint="https://query.wikidata.org/sparql"}</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a><span class="in">SELECT DISTINCT ?item ?itemLabel ?country ?countryLabel ?linkTo ?linkToLabel</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="in">WHERE {</span></span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a><span class="in">    ?item wdt:P1142 ?linkTo .</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a><span class="in">    ?linkTo wdt:P31 wd:Q12909644 .</span></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="in">    VALUES ?type { wd:Q7278  wd:Q24649 }</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="in">    ?item wdt:P31 ?type .</span></span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="in">    ?item wdt:P17 ?country .</span></span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="in">    MINUS { ?item wdt:P576 ?abolitionDate }</span></span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a><span class="in">    SERVICE wikibase:label { bd:serviceParam wikibase:language "[AUTO_LANGUAGE],en" . }</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="retrieve-a-list">Retrieve a list<a class="anchor" aria-label="anchor" href="#retrieve-a-list"></a>
</h4>
<p><em>output.var</em>: the name of the list you want to store the results in</p>
<p><em>endpoint</em>: the URL of the SPARQL endpoint</p>
<p><em>output.type</em> : when set to “list”, retrieves a list (tree structure) instead of a data-frame</p>
<p><em>autoproxy</em>: whether or not try to use the automatic proxy detection</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode markdown"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="in">```{sparql output.var="queryres_list", endpoint="https://lindas.admin.ch/query", output.type="list"}</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="in">PREFIX schema: &lt;http://schema.org/&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a><span class="in">SELECT * WHERE {</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="in">  ?sub a schema:DataCatalog .</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="in">  ?subtype a schema:DataType .</span></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="in">```</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="inline-code">Inline code<a class="anchor" aria-label="anchor" href="#inline-code"></a>
</h3>
<p>The inline functions <code>sparql2df</code> and <code>sparql2list</code> both have the same pair of arguments: a <em>SPARQL endpoint</em> and a <em>SPARQL query</em>. Queries can be multi-line:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"https://lindas.admin.ch/query"</span></span>
<span><span class="va">query</span> <span class="op">&lt;-</span> <span class="st">"PREFIX schema: &lt;http://schema.org/&gt;</span></span>
<span><span class="st">  SELECT * WHERE {</span></span>
<span><span class="st">  ?sub a schema:DataCatalog .</span></span>
<span><span class="st">  ?subtype a schema:DataType .</span></span>
<span><span class="st">}"</span></span></code></pre></div>
<div class="section level4">
<h4 id="retrieve-a-data-frame-1">Retrieve a data frame<a class="anchor" aria-label="anchor" href="#retrieve-a-data-frame-1"></a>
</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sparql2df.html">sparql2df</a></span><span class="op">(</span><span class="va">endpoint</span>,<span class="va">query</span><span class="op">)</span></span></code></pre></div>
<p>The same but with attempt at automatic proxy detection:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sparql2df.html">sparql2df</a></span><span class="op">(</span><span class="va">endpoint</span>,<span class="va">query</span>,autoproxy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="retrieve-a-list-1">Retrieve a list<a class="anchor" aria-label="anchor" href="#retrieve-a-list-1"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sparql2list.html">sparql2list</a></span><span class="op">(</span><span class="va">endpoint</span>,<span class="va">query</span><span class="op">)</span></span></code></pre></div>
<p>The same but with attempt at automatic proxy detection:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/sparql2list.html">sparql2list</a></span><span class="op">(</span><span class="va">endpoint</span>,<span class="va">query</span>,autoproxy<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/aourednik/SPARQLchunks/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/aourednik/SPARQLchunks/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>GPL (&gt;= 3)</small></li>
</ul>
</div>

<div class="community">
<h2 data-toc-skip>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>

<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing SPARQLchunks</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Andre Ourednik <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0309-8715" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://lifecycle.r-lib.org/articles/stages.html#stable" class="external-link"><img src="https://img.shields.io/badge/lifecycle-stable-brightgreen.svg" alt="Lifecycle: stable"></a></li>
<li><a href="https://app.codecov.io/gh/aourednik/SPARQLchunks" class="external-link"><img src="https://codecov.io/gh/aourednik/SPARQLchunks/graph/badge.svg" alt="Codecov test coverage"></a></li>
<li><a href="https://github.com/aourednik/SPARQLchunks/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/aourednik/SPARQLchunks/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andre Ourednik.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
